(()=>{"use strict";var t={};function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function e(t,n){for(var e=0;e<n.length;e++){var i=n[e];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,o(i.key),i)}}function o(t){var e=function(t){if("object"!=n(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var o=e.call(t,"string");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==n(e)?e:e+""}t.n=n=>{var e=n&&n.__esModule?()=>n.default:()=>n;return t.d(e,{a:e}),e},t.d=(n,e)=>{for(var o in e)t.o(e,o)&&!t.o(n,o)&&Object.defineProperty(n,o,{enumerable:!0,get:e[o]})},t.o=(t,n)=>Object.prototype.hasOwnProperty.call(t,n);const i=function(){return t=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.init()},(n=[{key:"init",value:function(){this.extendAttachmentDetails(),this.extendAttachmentDetailsTwoColumn()}},{key:"extendAttachmentDetails",value:function(){var t;null!==(t=wp)&&void 0!==t&&null!==(t=t.media)&&void 0!==t&&null!==(t=t.view)&&void 0!==t&&null!==(t=t.Attachment)&&void 0!==t&&t.Details&&(wp.media.view.Attachment.Details=wp.media.view.Attachment.Details.extend({template:function(t){var n=wp.media.template("attachment-details")(t);if("image"!==this.model.attributes.type)return n;var e=document.createElement("div");e.innerHTML=n;var o=this.getOptimizationControlHTML(t.compat.item);return o?(e.innerHTML+=o,e.innerHTML):e.innerHTML},getOptimizationControlHTML:function(t){var n,e=document.createElement("div");return e.innerHTML=t,null===(n=e.querySelector('input[name*="[image_optimization_modal]"]'))||void 0===n?void 0:n.value}}))}},{key:"extendAttachmentDetailsTwoColumn",value:function(){var t;null!==(t=wp)&&void 0!==t&&null!==(t=t.media)&&void 0!==t&&null!==(t=t.view)&&void 0!==t&&null!==(t=t.Attachment)&&void 0!==t&&null!==(t=t.Details)&&void 0!==t&&t.TwoColumn&&(wp.media.view.Attachment.Details.TwoColumn=wp.media.view.Attachment.Details.TwoColumn.extend({template:function(t){var n=wp.media.template("attachment-details-two-column")(t);if("image"!==this.model.attributes.type)return n;var e=document.createElement("div");e.innerHTML=n;var o=this.getOptimizationControlHTML(t.compat.item);return o?(e.querySelector(".settings").innerHTML+=o,e.innerHTML):e.innerHTML},getOptimizationControlHTML:function(t){var n,e=document.createElement("div");return e.innerHTML=t,null===(n=e.querySelector('input[name*="[image_optimization_modal]"]'))||void 0===n?void 0:n.value}}))}}])&&e(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n}(),r=window.wp.i18n,a=window.wp.a11y;var c=Object.freeze({optimizeButtonSelector:".image-optimization-control__button--optimize",reoptimizeButtonSelector:".image-optimization-control__button--reoptimize",tryAgainOptimizeButtonSelector:'[data-image-optimization-action="optimize"] .image-optimization-control__button--try-again',tryAgainReoptimizeButtonSelector:'[data-image-optimization-action="reoptimize"] .image-optimization-control__button--try-again',tryAgainRestoreButtonSelector:'[data-image-optimization-action="restore"] .image-optimization-control__button--try-again',controlWrapperSelector:".image-optimization-control",controlNotOptimizedClassName:"image-optimization-control image-optimization-control--not-optimized",controlLoadingClassName:"image-optimization-control image-optimization-control--loading",controlOptimizedClassName:"image-optimization-control image-optimization-control--optimized",controlErrorClassName:"image-optimization-control image-optimization-control--error",controlWrapper:{"list-view":"image-optimization-control--list-view","meta-box":"image-optimization-control--meta-box","details-view":"image-optimization-control--details-view"},restoreButtonSelector:".image-optimization-control__button--restore-original",loadingControlsSelector:'[data-image-optimization-status="loading"]',optimizationDetailsButtonSelector:".image-optimization-control__details-button",optimizationDetailsOptimizeButtonSelector:".image-optimization-details-table__optimization-button",optimizationDetailsWrapperId:"image-optimization-optimization-details-wrapper",optimizationDetailsModalId:"image-optimization-optimization-details-modal"});const l=window.wp.apiFetch;var s=t.n(l);const p=window.wp.url;function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function m(t){var n="function"==typeof Map?new Map:void 0;return m=function(t){if(null===t||!function(t){try{return-1!==Function.toString.call(t).indexOf("[native code]")}catch(n){return"function"==typeof t}}(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(t))return n.get(t);n.set(t,e)}function e(){return function(t,n,e){if(f())return Reflect.construct.apply(null,arguments);var o=[null];o.push.apply(o,n);var i=new(t.bind.apply(t,o));return e&&d(i,e.prototype),i}(t,arguments,g(this).constructor)}return e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),d(e,t)},m(t)}function f(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(t){}return(f=function(){return!!t})()}function d(t,n){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},d(t,n)}function g(t){return g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},g(t)}const y=function(t){function n(t){var e;return function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,n),(e=function(t,n,e){return n=g(n),function(t,n){if(n&&("object"==u(n)||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,f()?Reflect.construct(n,e||[],g(t).constructor):n.apply(t,e))}(this,n,[t])).name="APIError",e}return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),n&&d(t,n)}(n,t),e=n,Object.defineProperty(e,"prototype",{writable:!1}),e;var e}(m(Error));function v(t){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(t)}function b(){var t,n,e="function"==typeof Symbol?Symbol:{},o=e.iterator||"@@iterator",i=e.toStringTag||"@@toStringTag";function r(e,o,i,r){var l=o&&o.prototype instanceof c?o:c,s=Object.create(l.prototype);return _(s,"_invoke",function(e,o,i){var r,c,l,s=0,p=i||[],u=!1,m={p:0,n:0,v:t,a:f,f:f.bind(t,4),d:function(n,e){return r=n,c=0,l=t,m.n=e,a}};function f(e,o){for(c=e,l=o,n=0;!u&&s&&!i&&n<p.length;n++){var i,r=p[n],f=m.p,d=r[2];e>3?(i=d===o)&&(l=r[(c=r[4])?5:(c=3,3)],r[4]=r[5]=t):r[0]<=f&&((i=e<2&&f<r[1])?(c=0,m.v=o,m.n=r[1]):f<d&&(i=e<3||r[0]>o||o>d)&&(r[4]=e,r[5]=o,m.n=d,c=0))}if(i||e>1)return a;throw u=!0,o}return function(i,p,d){if(s>1)throw TypeError("Generator is already running");for(u&&1===p&&f(p,d),c=p,l=d;(n=c<2?t:l)||!u;){r||(c?c<3?(c>1&&(m.n=-1),f(c,l)):m.n=l:m.v=l);try{if(s=2,r){if(c||(i="next"),n=r[i]){if(!(n=n.call(r,l)))throw TypeError("iterator result is not an object");if(!n.done)return n;l=n.value,c<2&&(c=0)}else 1===c&&(n=r.return)&&n.call(r),c<2&&(l=TypeError("The iterator does not provide a '"+i+"' method"),c=1);r=t}else if((n=(u=m.n<0)?l:e.call(o,m))!==a)break}catch(n){r=t,c=1,l=n}finally{s=1}}return{value:n,done:u}}}(e,i,r),!0),s}var a={};function c(){}function l(){}function s(){}n=Object.getPrototypeOf;var p=[][o]?n(n([][o]())):(_(n={},o,function(){return this}),n),u=s.prototype=c.prototype=Object.create(p);function m(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,_(t,i,"GeneratorFunction")),t.prototype=Object.create(u),t}return l.prototype=s,_(u,"constructor",s),_(s,"constructor",l),l.displayName="GeneratorFunction",_(s,i,"GeneratorFunction"),_(u),_(u,i,"Generator"),_(u,o,function(){return this}),_(u,"toString",function(){return"[object Generator]"}),(b=function(){return{w:r,m}})()}function _(t,n,e,o){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}_=function(t,n,e,o){function r(n,e){_(t,n,function(t){return this._invoke(n,e,t)})}n?i?i(t,n,{value:e,enumerable:!o,configurable:!o,writable:!o}):t[n]=e:(r("next",0),r("throw",1),r("return",2))},_(t,n,e,o)}function z(t,n,e,o,i,r,a){try{var c=t[r](a),l=c.value}catch(t){return void e(t)}c.done?n(l):Promise.resolve(l).then(o,i)}function h(t){return function(){var n=this,e=arguments;return new Promise(function(o,i){var r=t.apply(n,e);function a(t){z(r,o,i,a,c,"next",t)}function c(t){z(r,o,i,a,c,"throw",t)}a(void 0)})}}function w(t,n){for(var e=0;e<n.length;e++){var o=n[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,O(o.key),o)}}function O(t){var n=function(t){if("object"!=v(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var e=n.call(t,"string");if("object"!=v(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==v(n)?n:n+""}var S="/image-optimizer/v1";const k=function(){function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t)}return n=t,e=[{key:"request",value:(c=h(b().m(function t(n){var e,o,i,r,a,c;return b().w(function(t){for(;;)switch(t.p=t.n){case 0:return e=n.path,o=n.data,i=n.method,r=void 0===i?"POST":i,t.p=1,t.n=2,s()({path:e,method:r,data:o});case 2:if((a=t.v).success){t.n=3;break}throw new y(a.data.message);case 3:return t.a(2,a.data);case 4:if(t.p=4,!((c=t.v)instanceof y)){t.n=5;break}throw c;case 5:throw new y(c.message);case 6:return t.a(2)}},t,null,[[1,4]])})),function(_x){return c.apply(this,arguments)})},{key:"optimizeSingleImage",value:(a=h(b().m(function n(e){var o,i,r,a;return b().w(function(n){for(;;)if(0===n.n)return i=e.imageId,r=e.reoptimize,a=void 0!==r&&r,n.a(2,t.request({path:"".concat(S,"/optimize/image"),data:{imageId:i,reoptimize:a,"image-optimization-optimize-image":null===(o=window)||void 0===o||null===(o=o.imageOptimizerControlSettings)||void 0===o?void 0:o.optimizeSingleImageNonce}}))},n)})),function(t){return a.apply(this,arguments)})},{key:"restoreSingleImage",value:(r=h(b().m(function n(e){var o;return b().w(function(n){for(;;)if(0===n.n)return n.a(2,t.request({path:"".concat(S,"/backups/restore/").concat(e),data:{"image-optimization-restore-single":null===(o=window)||void 0===o||null===(o=o.imageOptimizerControlSettings)||void 0===o?void 0:o.restoreSingleImageNonce}}))},n)})),function(t){return r.apply(this,arguments)})},{key:"getOptimizationStatus",value:(i=h(b().m(function n(e){return b().w(function(n){for(;;)if(0===n.n)return n.a(2,t.request({path:"".concat(S,"/optimize/status"),data:{image_ids:e}}))},n)})),function(t){return i.apply(this,arguments)})},{key:"getOptimizationDetails",value:(o=h(b().m(function n(e){var o;return b().w(function(n){for(;;)if(0===n.n)return o={image_id:e},n.a(2,t.request({method:"GET",path:(0,p.addQueryArgs)("".concat(S,"/stats/optimization-details"),o)}))},n)})),function(t){return o.apply(this,arguments)})}],e&&w(n,e),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,e,o,i,r,a,c}();function T(t){return T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T(t)}function j(t,n){for(var e=0;e<n.length;e++){var o=n[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,E(o.key),o)}}function E(t){var n=function(t){if("object"!=T(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var e=n.call(t,"string");if("object"!=T(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==T(n)?n:n+""}const P=function(){return t=function t(n){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.controlNode=n},(n=[{key:"getImageId",value:function(){var t,n;return null!==(t=this.controlNode.dataset)&&void 0!==t&&t.imageOptimizationImageId?parseInt(null===(n=this.controlNode.dataset)||void 0===n?void 0:n.imageOptimizationImageId,10):null}},{key:"getAction",value:function(){var t;return(null===(t=this.controlNode.dataset)||void 0===t?void 0:t.imageOptimizationAction)||null}},{key:"getContext",value:function(){var t;return(null===(t=this.controlNode.dataset)||void 0===t?void 0:t.imageOptimizationContext)||null}},{key:"getStatus",value:function(){var t;return(null===(t=this.controlNode.dataset)||void 0===t?void 0:t.imageOptimizationStatus)||null}},{key:"getErrorType",value:function(){var t;return(null===(t=this.controlNode.dataset)||void 0===t?void 0:t.imageOptimizationErrorType)||null}},{key:"canBeRestored",value:function(){var t,n=null===(t=this.controlNode.dataset)||void 0===t?void 0:t.imageOptimizationCanBeRestored;return n?"1"===n:null}},{key:"allowRetry",value:function(){var t;return"1"===(null===(t=this.controlNode.dataset)||void 0===t?void 0:t.imageOptimizationAllowRetry)}}])&&j(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n}(),C=window.wp.escapeHtml;var I=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,e=[
// translators: %s: file size in bytes
// translators: %s: file size in bytes
(0,r.__)("%s Bytes","image-optimization"),
// translators: %s: file size in kilobytes
// translators: %s: file size in kilobytes
(0,r.__)("%s Kb","image-optimization"),
// translators: %s: file size in megabytes
// translators: %s: file size in megabytes
(0,r.__)("%s Mb","image-optimization"),
// translators: %s: file size in gigabytes
// translators: %s: file size in gigabytes
(0,r.__)("%s Gb","image-optimization")];if(!t)
// translators: %s: file size in bytes
return(0,r.sprintf)((0,r.__)("%s Bytes","image-optimization"),0);var o=Math.floor(Math.log(t)/Math.log(1024)),i=parseFloat((t/Math.pow(1024,o)).toFixed(n));return(0,r.sprintf)(e[o],i)},L=function(t,n){return n?(0,p.addQueryArgs)(t,{subscription_id:n}):t},R=function(t){var n,e=t.errorType,o=t.imagesLeft,i=t.allowRetry,a=(null===(n=window)||void 0===n||null===(n=n.imageOptimizerUserData)||void 0===n?void 0:n.isElementorOne)||!1;if("auth-error"===e){var c,l=null===(c=window)||void 0===c||null===(c=c.imageOptimizerControlSettings)||void 0===c?void 0:c.connectLink;return'\n\t\t\t<a class="button button-secondary button-large image-optimization-control__button"\n\t\t\t\t href="'.concat(l,'"\n\t\t\t\t target="_blank" rel="noopener noreferrer">\n \t\t\t\t').concat((0,r.__)("Connect","image-optimization"),"\n\t\t\t</a>\n\t\t")}if("connection-error"===e)return'\n\t\t\t<button class="button button-secondary button-large button-link-delete image-optimization-control__button image-optimization-control__button--try-again"\n\t\t\t\t\t\t\ttype="button">\n\t\t\t\t'.concat((0,r.__)("Try again","image-optimization"),"\n\t\t\t</button>\n\t\t");if(void 0!==o&&0===o){var s;if(a)return"";var p=null===(s=window)||void 0===s||null===(s=s.imageOptimizerUserData)||void 0===s||null===(s=s.planData)||void 0===s?void 0:s.subscription_id;return'\n\t\t\t<a class="button button-secondary button-large image-optimization-control__button"\n\t\t\t\t href="'.concat(L("https://go.elementor.com/io-panel-upgrade/",p),'"\n\t\t\t\t target="_blank" rel="noopener noreferrer">\n \t\t\t\t').concat((0,r.__)("Upgrade","image-optimization"),"\n\t\t\t</a>\n\t\t")}return i?'\n\t\t\t<button class="button button-secondary button-large button-link-delete image-optimization-control__button image-optimization-control__button--try-again"\n\t\t\t\t\t\t\ttype="button">\n\t\t\t\t'.concat((0,r.__)("Try again","image-optimization"),"\n\t\t\t</button>\n\t\t"):void 0};const x=Object.freeze({notOptimizedTemplate:function(){return'\n\t\t<button type="button"\n\t\t\t\t\tclass="button button-primary image-optimization-control__button image-optimization-control__button--optimize">\n\t\t\t'.concat((0,r.__)("Optimize now","image-optimization"),"\n\t\t</button>\n\t")},loadingTemplate:function(t){var n;switch(t){case"restore":n=(0,r.__)("Restoring…","image-optimization");break;case"optimize":n=(0,r.__)("Optimizing…","image-optimization");break;case"reoptimize":n=(0,r.__)("Reoptimizing…","image-optimization");break;default:n=(0,r.__)("Loading…","image-optimization")}return'\n\t\t<button class="button button-secondary image-optimization-control__button image-optimization-control__button--optimize"\n\t\t\t\t\t\tdisabled="">\n\t\t\t<span class="spinner is-active"></span> '.concat(n,"\n\t\t</button>\n\t")},errorTemplate:function(t){var n=t.message,e=t.imagesLeft,o=t.errorType,i=t.allowRetry;return'\n\t\t<span class="image-optimization-control__error-message">'.concat((0,C.escapeHTML)(n),"</span>\n\n\t\t").concat(R({imagesLeft:e,errorType:o,allowRetry:i}),"\n\t")},optimizedTemplate:function(t){var n,e,o,i=I(null==t||null===(n=t.saved)||void 0===n?void 0:n.absolute,1);return'\n\t\t<p class="image-optimization-control__property">\n\t\t\t'.concat((0,r.__)("Image sizes optimized","image-optimization"),":\n\n\t\t\t<span>\n\t\t\t\t").concat(null==t?void 0:t.sizesOptimized,"/").concat(null==t?void 0:t.sizesTotal,'\n\n\t\t\t\t<button type="button"\n\t\t\t\t\t\t\t\tclass="image-optimization-control__details-button"\n\t\t\t\t\t\t\t\taria-label="').concat((0,r.__)("Open optimization details","image-optimization"),'">\n\t\t\t\t\t(+)\n\t\t\t\t</button>\n\t\t\t</span>\n\t\t</p>\n\n\t\t<p class="image-optimization-control__property">\n\t\t\t').concat(0!==(null==t||null===(e=t.saved)||void 0===e?void 0:e.absolute)?"".concat((0,r.__)("Overall saving","image-optimization"),": <span>").concat(null==t||null===(o=t.saved)||void 0===o?void 0:o.relative,"% (").concat(i,")</span>"):"<span>".concat((0,r.__)("Image is fully optimized","image-optimization"),"</span>"),'\n\t\t</p>\n\n\t\t<div class="image-optimization-control__buttons-wrapper">\n\t\t\t').concat(null!=t&&t.canBeRestored?'\n\t\t\t\t<button type="button"\n\t\t\t\t\tclass="button button-secondary image-optimization-control__button image-optimization-control__button--restore-original">\n\t\t\t\t\t'.concat((0,r.__)("Restore original","image-optimization"),"\n\t\t\t\t</button>\n\t\t\t"):"",'\n\n\t\t\t<button type="button"\n\t\t\t\tclass="button button-secondary image-optimization-control__button image-optimization-control__button--reoptimize">\n\t\t\t\t').concat((0,r.__)("Reoptimize","image-optimization"),"\n\t\t\t</button>\n\t\t</div>\n\t")}}),M=Object.freeze({notOptimizedTemplate:function(){return'\n\t\t<p class="image-optimization-control__property">\n\t\t\t'.concat((0,r.__)("Status","image-optimization"),':\n\n\t\t\t<span class="image-optimization-control__property-value">\n\t\t\t\t').concat((0,r.__)("Not optimized","image-optimization"),'\n\t\t\t</span>\n\t\t</p>\n\n\t\t<div class="image-optimization-control__action-button-wrapper">\n\t\t\t<button type="button"\n\t\t\t\t\t\t\tclass="button button-primary image-optimization-control__button image-optimization-control__button--optimize">\n\t\t\t\t').concat((0,r.__)("Optimize now","image-optimization"),"\n\t\t\t</button>\n\t\t</div>\n\t")},loadingTemplate:function(){return'\n\t\t<p class="image-optimization-control__property">\n\t\t\t'.concat((0,r.__)("Status","image-optimization"),':\n\n\t\t\t<span class="image-optimization-control__property-value">\n\t\t\t\t').concat((0,r.__)("In Progress","image-optimization"),'\n\t\t\t</span>\n\t\t</p>\n\n\t\t<div class="image-optimization-control__action-spinner-wrapper">\n\t\t\t<span class="spinner is-active"></span>\n\t\t</div>\n\t')},errorTemplate:function(t){var n=t.message,e=t.imagesLeft,o=t.errorType,i=t.allowRetry;return'\n\t\t<p class="image-optimization-control__property">\n\t\t\t'.concat((0,r.__)("Status","image-optimization"),':\n\n\t\t\t<span class="image-optimization-control__property-value">\n\t\t\t\t').concat((0,r.__)("Error","image-optimization"),'\n\t\t\t</span>\n\t\t</p>\n\n\t\t<p class="image-optimization-control__property">\n\t\t\t').concat((0,r.__)("Reason","image-optimization"),':\n\n\t\t\t<span class="image-optimization-control__property-value">\n\t\t\t\t').concat((0,C.escapeHTML)(n),'\n\t\t\t</span>\n\t\t</p>\n\n\t\t<div class="image-optimization-control__action-button-wrapper">\n\t\t\t').concat(R({imagesLeft:e,errorType:o,allowRetry:i}),"\n\t\t</div>\n\t")},optimizedTemplate:function(t){var n,e,o,i=I(null==t||null===(n=t.saved)||void 0===n?void 0:n.absolute,1);return'\n\t\t<p class="image-optimization-control__property">\n\t\t\t'.concat((0,r.__)("Status","image-optimization"),':\n\n\t\t\t<span class="image-optimization-control__property-value">\n\t\t\t\t').concat((0,r.__)("Optimized","image-optimization"),'\n\t\t\t</span>\n\t\t</p>\n\n\t\t<p class="image-optimization-control__property">\n\t\t\t').concat((0,r.__)("Image sizes optimized","image-optimization"),':\n\n\t\t\t<span class="image-optimization-control__property-value">\n\t\t\t\t').concat(null==t?void 0:t.sizesOptimized,"/").concat(null==t?void 0:t.sizesTotal,'\n\n\t\t\t\t<button type="button"\n\t\t\t\t\t\t\t\tclass="image-optimization-control__details-button"\n\t\t\t\t\t\t\t\taria-label="').concat((0,r.__)("Open optimization details","image-optimization"),'">\n\t\t\t\t\t(+)\n\t\t\t\t</button>\n\t\t\t</span>\n\t\t</p>\n\n\t\t<p class="image-optimization-control__property">\n\t\t\t').concat(0!==(null==t||null===(e=t.saved)||void 0===e?void 0:e.absolute)?'\n\t\t\t\t<span class="image-optimization-control__property-value">\n\t\t\t\t\t'.concat((0,r.__)("Overall saving","image-optimization"),": ").concat(null==t||null===(o=t.saved)||void 0===o?void 0:o.relative,"% (").concat(i,")\n\t\t\t\t</span>\n\t\t\t"):'\n\t\t\t\t<span class="image-optimization-control__property-value">\n\t\t\t\t\t'.concat((0,r.__)("Image is fully optimized","image-optimization"),"\n\t\t\t\t</span>\n\t\t\t"),'\n\t\t</p>\n\n\t\t<div class="image-optimization-control__action-button-wrapper">\n\t\t\t').concat(null!=t&&t.canBeRestored?'\n\t\t\t\t<button class="button button-link image-optimization-control__button image-optimization-control__button--restore-original"\n\t\t\t\t\t\t\t\ttype="button">\n\t\t\t\t\t'.concat((0,r.__)("Restore original","image-optimization"),"\n\t\t\t\t</button>\n\t\t\t"):"",'\n\n\t\t\t<button class="button button-link image-optimization-control__button image-optimization-control__button--reoptimize"\n\t\t\t\t\t\t\ttype="button">\n\t\t\t\t').concat((0,r.__)("Reoptimize","image-optimization"),"\n\t\t\t</button>\n\t\t</div>\n\t")}}),D=Object.freeze({notOptimizedTemplate:function(){return'\n\t\t<span class="setting image-optimization-setting">\n\t\t\t<span class="name image-optimization-control__property">\n\t\t\t\t'.concat((0,r.__)("Status","image-optimization"),':\n\t\t\t</span>\n\n\t\t\t<span class="image-optimization-control__property-value">\n\t\t\t\t').concat((0,r.__)("Not optimized","image-optimization"),'\n\t\t\t</span>\n\t\t</span>\n\n\t\t<span class="setting image-optimization-setting">\n\t\t\t<span class="name image-optimization-control__property"></span>\n\n\t\t\t<span class="image-optimization-control__property-value image-optimization-control__property-value--button">\n\t\t\t\t<button type="button"\n\t\t\t\t\t\t\tclass="button button-primary image-optimization-control__button image-optimization-control__button--optimize">\n\t\t\t\t\t').concat((0,r.__)("Optimize now","image-optimization"),"\n\t\t\t\t</button>\n\t\t\t</span>\n\t\t</span>\n\t")},loadingTemplate:function(){return'\n\t\t<span class="setting image-optimization-setting">\n\t\t\t<span class="name image-optimization-control__property">\n\t\t\t\t'.concat((0,r.__)("Status","image-optimization"),':\n\t\t\t</span>\n\n\t\t\t<span class="image-optimization-control__property-value">\n\t\t\t\t').concat((0,r.__)("In Progress","image-optimization"),'\n\t\t\t</span>\n\t\t</span>\n\n\t\t<span class="setting image-optimization-setting">\n\t\t\t<span class="name image-optimization-control__property"></span>\n\n\t\t\t<span class="image-optimization-control__property-value image-optimization-control__property-value--spinner">\n\t\t\t\t<span class="spinner is-active"></span>\n\t\t\t</span>\n\t\t</span>\n\t')},errorTemplate:function(t){var n=t.message,e=t.imagesLeft,o=t.errorType,i=t.allowRetry;return'\n\t\t<span class="setting image-optimization-setting">\n\t\t\t<span class="name image-optimization-control__property">\n\t\t\t\t'.concat((0,r.__)("Status","image-optimization"),':\n\t\t\t</span>\n\n\t\t\t<span class="image-optimization-control__property-value">\n\t\t\t\t').concat((0,r.__)("Error","image-optimization"),'\n\t\t\t</span>\n\t\t</span>\n\n\t\t<span class="setting image-optimization-setting">\n\t\t\t<span class="name image-optimization-control__property">\n\t\t\t\t').concat((0,r.__)("Reason","image-optimization"),':\n\t\t\t</span>\n\n\t\t\t<span class="image-optimization-control__property-value">\n\t\t\t\t').concat((0,C.escapeHTML)(n),'\n\t\t\t</span>\n\t\t</span>\n\n\t\t<span class="setting image-optimization-setting">\n\t\t\t<span class="name image-optimization-control__property"></span>\n\n\t\t\t<span class="image-optimization-control__property-value image-optimization-control__property-value--button">\n\t\t\t\t').concat(R({imagesLeft:e,errorType:o,allowRetry:i}),"\n\t\t\t</span>\n\t\t</span>\n\t")},optimizedTemplate:function(t){var n,e,o,i=I(null==t||null===(n=t.saved)||void 0===n?void 0:n.absolute,1);return'\n\t\t<span class="setting image-optimization-setting">\n\t\t\t<span class="name image-optimization-control__property">\n\t\t\t\t'.concat((0,r.__)("Status","image-optimization"),':\n\t\t\t</span>\n\n\t\t\t<span class="image-optimization-control__property-value">\n\t\t\t\t').concat((0,r.__)("Optimized","image-optimization"),'\n\t\t\t</span>\n\t\t</span>\n\n\t\t<span class="setting image-optimization-setting">\n\t\t\t<span class="name image-optimization-control__property">\n\t\t\t\t').concat((0,r.__)("Image sizes optimized","image-optimization"),':\n\t\t\t</span>\n\n\t\t\t<span class="image-optimization-control__property-value">\n\t\t\t\t').concat(null==t?void 0:t.sizesOptimized,"/").concat(null==t?void 0:t.sizesTotal,'\n\n\t\t\t\t<button type="button"\n\t\t\t\t\t\t\t\tclass="image-optimization-control__details-button"\n\t\t\t\t\t\t\t\taria-label="').concat((0,r.__)("Open optimization details","image-optimization"),'">\n\t\t\t\t\t(+)\n\t\t\t\t</button>\n\t\t\t</span>\n\t\t</span>\n\n\t\t<span class="setting image-optimization-setting">\n\t\t\t').concat(0!==(null==t||null===(e=t.saved)||void 0===e?void 0:e.absolute)?'<span class="name image-optimization-control__property">\n\t\t\t\t'.concat((0,r.__)("Overall saving","image-optimization"),':\n\t\t\t </span>\n\n\t\t\t <span class="image-optimization-control__property-value">\n\t\t\t\t').concat(null==t||null===(o=t.saved)||void 0===o?void 0:o.relative,"% (").concat(i,")\n\t\t\t </span>"):'<span class="name image-optimization-control__property"></span>\n\n\t\t\t <span class="image-optimization-control__property-value">\n\t\t\t\t'.concat((0,r.__)("Image is fully optimized","image-optimization"),"\n\t\t\t </span>"),'\n\t\t</span>\n\n\t\t<span class="setting image-optimization-setting">\n\t\t\t<span class="name image-optimization-control__property"></span>\n\n\t\t\t<span class="image-optimization-control__property-value image-optimization-control__property-value--button">\n\t\t\t\t<button class="button button-link image-optimization-control__button image-optimization-control__button--reoptimize"\n\t\t\t\t\t\t\t\ttype="button">\n\t\t\t\t\t').concat((0,r.__)("Reoptimize","image-optimization"),"\n\t\t\t\t</button>\n\t\t\t</span>\n\t\t</span>\n\n\t\t").concat(null!=t&&t.canBeRestored?'\n\t\t\t<span class="setting image-optimization-setting">\n\t\t\t\t<span class="name image-optimization-control__property"></span>\n\n\t\t\t\t<span class="image-optimization-control__property-value image-optimization-control__property-value--button">\n\t\t\t\t\t<button class="button button-link image-optimization-control__button image-optimization-control__button--restore-original"\n\t\t\t\t\t\t\t\t\ttype="button">\n\t\t\t\t\t\t'.concat((0,r.__)("Restore original","image-optimization"),"\n\t\t\t\t\t</button>\n\t\t\t\t</span>\n\t\t\t</span>\n\t"):"","\n\t")}});function B(t){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},B(t)}function N(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);n&&(o=o.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),e.push.apply(e,o)}return e}function A(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?N(Object(e),!0).forEach(function(n){W(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):N(Object(e)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}function W(t,n,e){return(n=F(n))in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}function H(t,n){for(var e=0;e<n.length;e++){var o=n[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,F(o.key),o)}}function F(t){var n=function(t){if("object"!=B(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var e=n.call(t,"string");if("object"!=B(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==B(n)?n:n+""}const G=function(){return t=function t(n){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.controlWrapper=n,this.context=new P(n).getContext(),this.action=new P(n).getAction(),this.canBeRestored=new P(n).canBeRestored(),this.templates={"list-view":x,"meta-box":M,"details-view":D}},(n=[{key:"renderNotOptimized",value:function(t){this.controlWrapper.className=this.mixControlContextClass(c.controlNotOptimizedClassName),this.controlWrapper.innerHTML=this.getTemplates().notOptimizedTemplate(t),this.controlWrapper.dataset.imageOptimizationStatus="not-optimized"}},{key:"renderOptimized",value:function(t){var n,e=this.canBeRestored&&0!==(null==t||null===(n=t.saved)||void 0===n?void 0:n.absolute);this.controlWrapper.className=this.mixControlContextClass(c.controlOptimizedClassName),this.controlWrapper.innerHTML=this.getTemplates().optimizedTemplate(A(A({},t),{},{canBeRestored:e})),this.controlWrapper.dataset.imageOptimizationStatus="optimized"}},{key:"renderError",value:function(t){var n=t.message,e=t.errorType,o=t.imagesLeft,i=t.allowRetry,r=t.action;this.controlWrapper.className=this.mixControlContextClass(c.controlErrorClassName),this.controlWrapper.innerHTML=this.getTemplates().errorTemplate({message:n,errorType:e,imagesLeft:o,allowRetry:i}),this.controlWrapper.dataset.imageOptimizationAction=r,this.controlWrapper.dataset.imageOptimizationStatus="error"}},{key:"renderLoading",value:function(t){this.controlWrapper.className=this.mixControlContextClass(c.controlLoadingClassName),this.controlWrapper.innerHTML=this.getTemplates().loadingTemplate(t),this.controlWrapper.dataset.imageOptimizationStatus="loading"}},{key:"getTemplates",value:function(){var t=this.templates[this.context];if(!t)throw new Error("No templates found for the context ".concat(this.context));return t}},{key:"mixControlContextClass",value:function(t){var n=c.controlWrapper[this.context];if(!n)throw new Error("No context className found for the context ".concat(this.context));return"".concat(t," ").concat(n)}}])&&H(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n}();function q(t){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},q(t)}function U(){var t,n,e="function"==typeof Symbol?Symbol:{},o=e.iterator||"@@iterator",i=e.toStringTag||"@@toStringTag";function r(e,o,i,r){var l=o&&o.prototype instanceof c?o:c,s=Object.create(l.prototype);return $(s,"_invoke",function(e,o,i){var r,c,l,s=0,p=i||[],u=!1,m={p:0,n:0,v:t,a:f,f:f.bind(t,4),d:function(n,e){return r=n,c=0,l=t,m.n=e,a}};function f(e,o){for(c=e,l=o,n=0;!u&&s&&!i&&n<p.length;n++){var i,r=p[n],f=m.p,d=r[2];e>3?(i=d===o)&&(l=r[(c=r[4])?5:(c=3,3)],r[4]=r[5]=t):r[0]<=f&&((i=e<2&&f<r[1])?(c=0,m.v=o,m.n=r[1]):f<d&&(i=e<3||r[0]>o||o>d)&&(r[4]=e,r[5]=o,m.n=d,c=0))}if(i||e>1)return a;throw u=!0,o}return function(i,p,d){if(s>1)throw TypeError("Generator is already running");for(u&&1===p&&f(p,d),c=p,l=d;(n=c<2?t:l)||!u;){r||(c?c<3?(c>1&&(m.n=-1),f(c,l)):m.n=l:m.v=l);try{if(s=2,r){if(c||(i="next"),n=r[i]){if(!(n=n.call(r,l)))throw TypeError("iterator result is not an object");if(!n.done)return n;l=n.value,c<2&&(c=0)}else 1===c&&(n=r.return)&&n.call(r),c<2&&(l=TypeError("The iterator does not provide a '"+i+"' method"),c=1);r=t}else if((n=(u=m.n<0)?l:e.call(o,m))!==a)break}catch(n){r=t,c=1,l=n}finally{s=1}}return{value:n,done:u}}}(e,i,r),!0),s}var a={};function c(){}function l(){}function s(){}n=Object.getPrototypeOf;var p=[][o]?n(n([][o]())):($(n={},o,function(){return this}),n),u=s.prototype=c.prototype=Object.create(p);function m(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,$(t,i,"GeneratorFunction")),t.prototype=Object.create(u),t}return l.prototype=s,$(u,"constructor",s),$(s,"constructor",l),l.displayName="GeneratorFunction",$(s,i,"GeneratorFunction"),$(u),$(u,i,"Generator"),$(u,o,function(){return this}),$(u,"toString",function(){return"[object Generator]"}),(U=function(){return{w:r,m}})()}function $(t,n,e,o){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}$=function(t,n,e,o){function r(n,e){$(t,n,function(t){return this._invoke(n,e,t)})}n?i?i(t,n,{value:e,enumerable:!o,configurable:!o,writable:!o}):t[n]=e:(r("next",0),r("throw",1),r("return",2))},$(t,n,e,o)}function Q(t,n,e,o,i,r,a){try{var c=t[r](a),l=c.value}catch(t){return void e(t)}c.done?n(l):Promise.resolve(l).then(o,i)}function K(t,n){for(var e=0;e<n.length;e++){var o=n[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,J(o.key),o)}}function J(t){var n=function(t){if("object"!=q(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var e=n.call(t,"string");if("object"!=q(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==q(n)?n:n+""}const V=function(){return t=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t)},n=[{key:"run",value:(e=U().m(function t(){var n,e,o,i;return U().w(function(t){for(;;)switch(t.n){case 0:if((n=document.querySelectorAll(c.controlWrapperSelector)).length){t.n=1;break}return t.a(2);case 1:return e=this.mapImageIds(n),t.n=2,k.getOptimizationStatus(e);case 2:o=t.v,i=o.status,n.forEach(function(t){var n=new P(t).getImageId(),e=new P(t).getStatus(),o=i[n],r=new G(t);if(e!==o.status)if("true"!==t.dataset.isFrozen)switch(o.status){case"optimization-in-progress":r.renderLoading("optimize");break;case"reoptimizing-in-progress":r.renderLoading("reoptimize");break;case"restoring-in-progress":r.renderLoading("restore");break;case"not-optimized":r.renderNotOptimized();break;case"optimized":var a={sizesTotal:o.stats.total_image_count,sizesOptimized:o.stats.optimized_image_count,saved:{absolute:o.stats.initial_image_size-o.stats.current_image_size,relative:Math.max(100-Math.round(o.stats.current_image_size/o.stats.initial_image_size*100),0)}};r.renderOptimized(a);break;case"optimization-failed":r.renderError({message:o.message,errorType:o.error_type,imagesLeft:o.images_left,allowRetry:new P(t).allowRetry(),action:"optimize"});break;case"reoptimizing-failed":r.renderError({message:o.message,errorType:o.error_type,imagesLeft:o.images_left,allowRetry:new P(t).allowRetry(),action:"reoptimize"});break;case"restoring-failed":r.renderError({message:o.message,action:"restore"})}else t.dataset.isFrozen=!1});case 3:return t.a(2)}},t,this)}),o=function(){var t=this,n=arguments;return new Promise(function(o,i){var r=e.apply(t,n);function a(t){Q(r,o,i,a,c,"next",t)}function c(t){Q(r,o,i,a,c,"throw",t)}a(void 0)})},function(){return o.apply(this,arguments)})},{key:"mapImageIds",value:function(t){return Array.prototype.map.call(t,function(t){return new P(t).getImageId()})}}],n&&K(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,e,o}(),X=Object.freeze({header:function(){return'\n\t\t<div>\n\t\t\t<table class="wp-list-table widefat striped image-optimization-details-table">\n\t\t\t\t<thead>\n\t\t\t\t\t<tr>\n\t\t\t\t\t\t<th>'.concat((0,r.__)("Size Name","image-optimization"),"</th>\n\t\t\t\t\t\t<th>").concat((0,r.__)("Image Size","image-optimization"),"</th>\n\t\t\t\t\t\t<th>").concat((0,r.__)("Savings","image-optimization"),"</th>\n\t\t\t\t\t\t<th></th>\n\t\t\t\t\t</tr>\n\t\t\t\t</thead>\n\n\t\t\t\t<tbody>\n\t")},footer:function(t){var n=(0,r.sprintf)(
// Translators: %s - total file size
// Translators: %s - total file size
(0,r.__)("Total: %s","image-optimization"),I(null==t?void 0:t.total));return"\n\t\t\t\t</tbody>\n\t\t\t</table>\n\n\t\t\t<p>\n\t\t\t\t<b>\n\t\t\t\t\t".concat(n,"\n\t\t\t\t</b>\n\t\t\t</p>\n\t\t</div>\n\t")},rowStart:function(t){return'\n  \t<tr>\n  \t\t<td class="image-optimization-details-table__size-name"><b>'.concat(t.size_name,'</b></td>\n  \t\t<td class="image-optimization-details-table__size">').concat(I(t.file_size),"</td>\n  ")},rowEnd:function(){return"</tr>"},optimizedChunk:function(t){var n=(0,r.sprintf)(
// Translators: %1$s: Optimization percentage, %2$ file size decrease
// Translators: %1$s: Optimization percentage, %2$ file size decrease
(0,r.__)("Reduced by %1$s%% (%2$s)","image-optimization"),t.saved.relative,I(t.saved.absolute)),e=t.new_dimensions?(0,r.sprintf)(
// Translators: %1$s: Width, %2$ height
// Translators: %1$s: Width, %2$ height
(0,r.__)("Resized to %1$s(w) x %2$s(h)","image-optimization"),t.new_dimensions.width,t.new_dimensions.height):"";return'\n\t\t<td class="image-optimization-details-table__status">\n\t\t\t<span class="image-optimization-details-table__property">\n\t\t\t\t'.concat(n,'\n\t\t\t</span>\n\n\t\t\t<span class="image-optimization-details-table__property">\n\t\t\t\t').concat(e,'\n\t\t\t</span>\n\t\t</td>\n\n\t\t<td class="image-optimization-details-table__action"></td>\n\t')},notOptimizedChunk:function(t){return'\n\t\t<td class="image-optimization-details-table__status">\n\t\t\t<span class="image-optimization-details-table__property">\n\t\t\t\t'.concat((0,r.__)("Not optimized","image-optimization"),'\n\t\t\t</span>\n\t\t</td>\n\n\t\t<td class="image-optimization-details-table__action">\n\t\t\t\t<button type="button"\n\t\t\t\t\t\t\t\tclass="button button-primary image-optimization-details-table__optimization-button"\n\t\t\t\t\t\t\t\tdata-image-id="').concat(t.imageId,'">\n\t\t\t\t\t').concat((0,r.__)("Optimize","image-optimization"),"\n\t\t\t\t</button>\n\t\t</td>\n\t")},notFoundChunk:function(){return'\n\t\t<td class="image-optimization-details-table__status">\n\t\t\t<span class="image-optimization-details-table__property image-optimization-details-table__property--error">\n\t\t\t\t'.concat((0,r.__)("File is missing","image-optimization"),'\n\t\t\t</span>\n  \t</td>\n\n  \t<td class="image-optimization-details-table__action"></td>\n\t')},tooLargeChunk:function(){var t,n,e=(0,r.sprintf)(
// Translators: %s - max file size
// Translators: %s - max file size
(0,r.__)("File is too large. Max size is %s","image-optimization"),I(null===(t=window)||void 0===t||null===(t=t.imageOptimizerUserData)||void 0===t?void 0:t.maxFileSize)),o=null===(n=window)||void 0===n||null===(n=n.imageOptimizerUserData)||void 0===n||null===(n=n.planData)||void 0===n?void 0:n.subscription_id;return'\n\t\t<td class="image-optimization-details-table__status">\n\t\t\t<span class="image-optimization-details-table__property">\n\t\t\t\t'.concat(e,'\n\t\t\t</span>\n  \t</td>\n\n  \t<td class="image-optimization-details-table__action">\n  \t\t<a class="button button-primary button-large"\n\t\t\t\t href="').concat(L("https://go.elementor.com/io-panel-upgrade/",o),'"\n\t\t\t\t target="_blank" rel="noopener noreferrer">\n\t\t\t\t').concat((0,r.__)("Upgrade","image-optimization"),"\n\t\t\t</a>\n\t\t</td>\n\t")},error:function(t){return'\n\t\t<span class="image-optimization-details-table__error">'.concat(t.message,"</span>\n\t")}});function Y(t){return Y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Y(t)}function Z(t,n){for(var e=0;e<n.length;e++){var o=n[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,tt(o.key),o)}}function tt(t){var n=function(t){if("object"!=Y(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var e=n.call(t,"string");if("object"!=Y(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Y(n)?n:n+""}const nt=function(){function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t)}return n=t,e=[{key:"modalTemplateExists",value:function(){return!!document.getElementById(c.optimizationDetailsModalId)}},{key:"initModal",value:function(){if(!t.modalTemplateExists()){var n=document.createElement("div");n.id=c.optimizationDetailsWrapperId,n.style="display:none;",n.innerHTML='<div id="'.concat(c.optimizationDetailsModalId,'"></div>'),document.body.appendChild(n)}}},{key:"openModal",value:function(){var t;tb_show((0,r.__)("Optimization Details","image-optimization"),"#TB_inline?width=".concat(700,"&height=").concat(500,"&inlineId=").concat(c.optimizationDetailsWrapperId)),null===(t=document.getElementById(c.optimizationDetailsWrapperId))||void 0===t||t.remove()}},{key:"closeModal",value:function(){tb_remove()}},{key:"renderError",value:function(t){var n=document.getElementById(c.optimizationDetailsModalId);if(!n)return!1;var e=X.error;return n.innerHTML=e({message:t}),!0}},{key:"renderLoading",value:function(){tb_click()}},{key:"renderData",value:function(t,n){var e=document.getElementById(c.optimizationDetailsModalId);if(!e)return!1;var o=X.header,i=X.footer,r=X.rowStart,a=X.rowEnd,l=X.optimizedChunk,s=X.notOptimizedChunk,p=X.notFoundChunk,u=X.tooLargeChunk,m=o();return null==n||n.sizes.forEach(function(n){m+=r(n),"optimized"===n.status&&(m+=l(n)),"not-optimized"===n.status&&(m+=s({imageId:t})),"file-not-found"===n.status&&(m+=p()),"file-too-large"===n.status&&(m+=u()),m+=a()}),m+=i(n),e.innerHTML=m,!0}}],null&&Z(n.prototype,null),e&&Z(n,e),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,e}();function et(t){return et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},et(t)}function ot(){var t,n,e="function"==typeof Symbol?Symbol:{},o=e.iterator||"@@iterator",i=e.toStringTag||"@@toStringTag";function r(e,o,i,r){var l=o&&o.prototype instanceof c?o:c,s=Object.create(l.prototype);return it(s,"_invoke",function(e,o,i){var r,c,l,s=0,p=i||[],u=!1,m={p:0,n:0,v:t,a:f,f:f.bind(t,4),d:function(n,e){return r=n,c=0,l=t,m.n=e,a}};function f(e,o){for(c=e,l=o,n=0;!u&&s&&!i&&n<p.length;n++){var i,r=p[n],f=m.p,d=r[2];e>3?(i=d===o)&&(l=r[(c=r[4])?5:(c=3,3)],r[4]=r[5]=t):r[0]<=f&&((i=e<2&&f<r[1])?(c=0,m.v=o,m.n=r[1]):f<d&&(i=e<3||r[0]>o||o>d)&&(r[4]=e,r[5]=o,m.n=d,c=0))}if(i||e>1)return a;throw u=!0,o}return function(i,p,d){if(s>1)throw TypeError("Generator is already running");for(u&&1===p&&f(p,d),c=p,l=d;(n=c<2?t:l)||!u;){r||(c?c<3?(c>1&&(m.n=-1),f(c,l)):m.n=l:m.v=l);try{if(s=2,r){if(c||(i="next"),n=r[i]){if(!(n=n.call(r,l)))throw TypeError("iterator result is not an object");if(!n.done)return n;l=n.value,c<2&&(c=0)}else 1===c&&(n=r.return)&&n.call(r),c<2&&(l=TypeError("The iterator does not provide a '"+i+"' method"),c=1);r=t}else if((n=(u=m.n<0)?l:e.call(o,m))!==a)break}catch(n){r=t,c=1,l=n}finally{s=1}}return{value:n,done:u}}}(e,i,r),!0),s}var a={};function c(){}function l(){}function s(){}n=Object.getPrototypeOf;var p=[][o]?n(n([][o]())):(it(n={},o,function(){return this}),n),u=s.prototype=c.prototype=Object.create(p);function m(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,s):(t.__proto__=s,it(t,i,"GeneratorFunction")),t.prototype=Object.create(u),t}return l.prototype=s,it(u,"constructor",s),it(s,"constructor",l),l.displayName="GeneratorFunction",it(s,i,"GeneratorFunction"),it(u),it(u,i,"Generator"),it(u,o,function(){return this}),it(u,"toString",function(){return"[object Generator]"}),(ot=function(){return{w:r,m}})()}function it(t,n,e,o){var i=Object.defineProperty;try{i({},"",{})}catch(t){i=0}it=function(t,n,e,o){function r(n,e){it(t,n,function(t){return this._invoke(n,e,t)})}n?i?i(t,n,{value:e,enumerable:!o,configurable:!o,writable:!o}):t[n]=e:(r("next",0),r("throw",1),r("return",2))},it(t,n,e,o)}function rt(t,n,e,o,i,r,a){try{var c=t[r](a),l=c.value}catch(t){return void e(t)}c.done?n(l):Promise.resolve(l).then(o,i)}function at(t){return function(){var n=this,e=arguments;return new Promise(function(o,i){var r=t.apply(n,e);function a(t){rt(r,o,i,a,c,"next",t)}function c(t){rt(r,o,i,a,c,"throw",t)}a(void 0)})}}function ct(t,n){for(var e=0;e<n.length;e++){var o=n[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,lt(o.key),o)}}function lt(t){var n=function(t){if("object"!=et(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var e=n.call(t,"string");if("object"!=et(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==et(n)?n:n+""}const st=function(){return t=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.controlSyncRequestInProgress=!1,this.init(),this.controlSync=new V},n=[{key:"init",value:function(){var t=this;this.initEventListeners(),setInterval(function(){return t.runStatusCheckLoop()},5e3)}},{key:"runStatusCheckLoop",value:(p=at(ot().m(function t(){return ot().w(function(t){for(;;)switch(t.n){case 0:if(!this.controlSyncRequestInProgress){t.n=1;break}return t.a(2);case 1:return this.controlSyncRequestInProgress=!0,t.n=2,this.controlSync.run();case 2:this.controlSyncRequestInProgress=!1;case 3:return t.a(2)}},t,this)})),function(){return p.apply(this,arguments)})},{key:"initEventListeners",value:function(){var t=this;document.addEventListener("click",function(n){return t.handleOptimizeButtonClick(n)}),document.addEventListener("click",function(n){return t.handleReoptimizeButtonClick(n)}),document.addEventListener("click",function(n){return t.handleRestoreButtonClick(n)}),document.addEventListener("click",function(n){return t.handleOptimizationDetailsOpen(n)}),document.addEventListener("click",function(n){return t.handleOptimizationDetailsClick(n)})}},{key:"handleOptimizeButtonClick",value:(s=at(ot().m(function t(n){var e,o,i;return ot().w(function(t){for(;;)switch(t.p=t.n){case 0:if(n.target.closest("".concat(c.optimizeButtonSelector,", ").concat(c.tryAgainOptimizeButtonSelector))){t.n=1;break}return t.a(2);case 1:return(0,a.speak)((0,r.__)("Optimization is in progress","image-optimization"),"assertive"),e=n.target.closest(c.controlWrapperSelector),(o=new G(e)).renderLoading("optimize"),t.p=2,e.dataset.isFrozen=!0,t.n=3,k.optimizeSingleImage({imageId:new P(e).getImageId(),reoptimize:!1});case 3:t.n=5;break;case 4:t.p=4,i=t.v,o.renderError(i);case 5:return t.a(2)}},t,null,[[2,4]])})),function(_x){return s.apply(this,arguments)})},{key:"handleReoptimizeButtonClick",value:(l=at(ot().m(function t(n){var e,o,i;return ot().w(function(t){for(;;)switch(t.p=t.n){case 0:if(n.target.closest("".concat(c.reoptimizeButtonSelector,", ").concat(c.tryAgainReoptimizeButtonSelector))){t.n=1;break}return t.a(2);case 1:return(0,a.speak)((0,r.__)("Reoptimizing is in progress","image-optimization"),"assertive"),e=n.target.closest(c.controlWrapperSelector),(o=new G(e)).renderLoading("reoptimize"),t.p=2,e.dataset.isFrozen=!0,t.n=3,k.optimizeSingleImage({imageId:new P(e).getImageId(),reoptimize:!0});case 3:t.n=5;break;case 4:t.p=4,i=t.v,o.renderError(i);case 5:return t.a(2)}},t,null,[[2,4]])})),function(t){return l.apply(this,arguments)})},{key:"handleRestoreButtonClick",value:(i=at(ot().m(function t(n){var e,o,i;return ot().w(function(t){for(;;)switch(t.p=t.n){case 0:if(n.target.closest("".concat(c.restoreButtonSelector,", ").concat(c.tryAgainRestoreButtonSelector))){t.n=1;break}return t.a(2);case 1:return(0,a.speak)((0,r.__)("Image restoring is in progress","image-optimization"),"assertive"),e=n.target.closest(c.controlWrapperSelector),(o=new G(e)).renderLoading("restore"),t.p=2,e.dataset.isFrozen=!0,t.n=3,k.restoreSingleImage(new P(e).getImageId());case 3:t.n=5;break;case 4:t.p=4,i=t.v,o.renderError(i);case 5:return t.a(2)}},t,null,[[2,4]])})),function(t){return i.apply(this,arguments)})},{key:"handleOptimizationDetailsOpen",value:(o=at(ot().m(function t(n){var e,o,i,r;return ot().w(function(t){for(;;)switch(t.p=t.n){case 0:if(n.target.closest("".concat(c.optimizationDetailsButtonSelector))){t.n=1;break}return t.a(2);case 1:return e=n.target.closest(c.controlWrapperSelector),o=new P(e).getImageId(),t.p=2,nt.initModal(),nt.renderLoading(),t.n=3,k.getOptimizationDetails(o);case 3:i=t.v,nt.openModal(),nt.renderData(o,i),t.n=5;break;case 4:t.p=4,r=t.v,nt.openModal(),nt.renderError(r.message);case 5:return t.a(2)}},t,null,[[2,4]])})),function(t){return o.apply(this,arguments)})},{key:"handleOptimizationDetailsClick",value:(e=at(ot().m(function t(n){var e,o,i;return ot().w(function(t){for(;;)switch(t.n){case 0:if(n.target.closest("".concat(c.optimizationDetailsOptimizeButtonSelector))){t.n=1;break}return t.a(2);case 1:return o=parseInt(null===(e=n.target.dataset)||void 0===e?void 0:e.imageId,10),t.n=2,k.optimizeSingleImage({imageId:o});case 2:(i=document.querySelector('.image-optimization-control[data-image-optimization-image-id="'.concat(o,'"]')))&&new G(i).renderLoading("optimize"),nt.closeModal();case 3:return t.a(2)}},t)})),function(t){return e.apply(this,arguments)})}],n&&ct(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n,e,o,i,l,s,p}();function pt(t){return pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pt(t)}function ut(t,n){for(var e=0;e<n.length;e++){var o=n[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,mt(o.key),o)}}function mt(t){var n=function(t){if("object"!=pt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var e=n.call(t,"string");if("object"!=pt(e))return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==pt(n)?n:n+""}var ft=function(){return t=function t(){!function(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}(this,t),this.init()},(n=[{key:"init",value:function(){new i,new st}}])&&ut(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,n}();document.addEventListener("DOMContentLoaded",function(){return new ft})})();